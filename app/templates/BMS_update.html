<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Update Panel - BMS</title>
    <link rel="stylesheet" href="/static/css/BMSadmin.css">
</head>
<body>

<div class="section-box">
    <h2>[ ðŸ”„ UPDATE PANEL ]</h2>

    <h3>Git Update</h3>
    <button onclick="runUpdate()">Update (git pull)</button>

    <h3>Install PIP Package</h3>
    <input id="pkg" placeholder="Nama package" class="input-text"/>
    <button onclick="installPkg()">Install Package</button>

    <h3>Server Control</h3>
    <button onclick="runRestart()">Restart Server</button>
    <button onclick="runShutdown()">Shutdown Server</button>

    <h3>Logs</h3>
    <button onclick="loadLog()">Load Log</button>
    <button onclick="clearLog()">Clear Log</button>

    <pre id="logbox"
         style="background:black;color:#0f0;padding:10px;height:300px;overflow:auto;">
    </pre>
</div>

<script>
function runUpdate(){
    fetch('/tools/update').then(r=>r.text()).then(alert);
}
function installPkg(){
    let p = document.getElementById("pkg").value;
    let f = new FormData();
    f.append("package", p);
    fetch('/tools/install',{method:"POST",body:f}).then(r=>r.text()).then(alert);
}
function runRestart(){
    fetch('/tools/restart').then(r=>r.text()).then(alert);
}
function runShutdown(){
    fetch('/tools/shutdown').then(r=>r.text()).then(alert);
}
function loadLog(){
    fetch('/tools/log').then(r=>r.text()).then(t=>{document.getElementById("logbox").textContent = t;});
}
function clearLog(){
    fetch('/tools/log/clear').then(r=>r.text()).then(()=>loadLog());
}
</script>

</body>
</html>